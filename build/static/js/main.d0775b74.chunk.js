(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{2:function(e,t){e.exports={COMMUNITY_CHAT:"COMMUNITY_CHAT",USER_CONNECTED:"USER_CONNECTED",MESSAGE_RECIEVED:"MESSAGE_RECIEVED",MESSAGE_SENT:"MESSAGE_SENT",USER_DISCONNECTED:"USER_DISCONNECTED",TYPING:"TYPING",VERIFY_USER:"VERIFY_USER",LOGOUT:"LOGOUT",PRIVTE_MESSAGE:"PRIVTE_MESSAGE",POSITIVE:"positive",NEGATIVE:"negative"}},41:function(e,t,n){e.exports=n(85)},46:function(e,t,n){},47:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},48:function(e,t,n){},77:function(e,t){},81:function(e,t,n){var a=n(82),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.filter(function(e){return e.name!==t}).join(" & ")||"Empty Users"},i=function(e){return"".concat(e.getHours(),":").concat(("0"+e.getMinutes()).slice(-2))};e.exports={createUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=void 0===t?"":t,s=e.socketId,i=void 0===s?null:s;return{id:a(),name:n,socketId:i}},createMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=void 0===t?"":t,s=e.sender,c=void 0===s?"":s;return{id:a(),time:i(new Date(Date.now())),message:n,sender:c}},createChat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.messages,n=void 0===t?[]:t,i=(e.name,e.users),c=void 0===i?[]:i,r=e.isCommunity,o=void 0!==r&&r;return{id:a(),name:o?"Community":s(c),messages:n,users:c,typingUsers:[],isCommunity:o}},createChatNameFromUsers:s}},85:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(37),c=n.n(i),r=(n(46),n(3)),o=n(4),l=n(6),u=n(5),m=n(7),d=(n(47),n(48),n(49),n(38)),h=n.n(d),v=n(2),p=n(40),E=n(8),f=n(9),g=n(39),C=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.active,n=e.lastMessage,a=e.name,i=e.onClick;return s.a.createElement("div",{className:"user ".concat(t?"active":""),onClick:i},s.a.createElement("div",{className:"user-photo"},a[0].toUpperCase()),s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"name"},a),s.a.createElement("div",{className:"last-message"},n)))}}]),t}(a.PureComponent);C.defaultProps={lastMessage:"",active:!1,onClock:function(){}};var S=n(10),b=(n(81),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t=n.state.reciever;(0,n.props.onSendPrivateMessage)(t)},n.addChatForUser=function(e){n.setActiveSideBar(t.types.CHATS),n.props.onSendPrivateMessage(e)},n.setActiveSideBar=function(e){n.setState({activeSideBar:e})},n.state={reciever:"",activeSideBar:t.types.CHATS},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,n=this.props,a=n.chats,i=n.activeChat,c=n.user,r=n.users,o=n.setActiveChat,l=n.logout,u=this.state,m=(u.reciever,u.activeSideBar);return s.a.createElement("div",{id:"side-bar"},s.a.createElement("div",{className:"heading"},s.a.createElement("div",{className:"app-name"},"Zanjo Chat",s.a.createElement(f.a,null)),s.a.createElement("div",{className:"menu"})),s.a.createElement("form",{onSubmit:this.handleSubmit,className:"search"},s.a.createElement("i",{className:"search-icon"},s.a.createElement(f.c,null)),s.a.createElement("input",{value:this.state.reciever,onChange:function(t){e.setState({reciever:t.target.value})},placeholder:"Search",type:"text"}),s.a.createElement("div",{className:"plus"})),s.a.createElement("div",{className:"side-bar-select"},s.a.createElement("button",{onClick:function(){e.setActiveSideBar(t.types.CHATS)},className:"side-bar-select__option ".concat(m===t.types.CHATS?"active":"")},"Chats"),s.a.createElement("button",{onClick:function(){e.setActiveSideBar(t.types.USERS)},className:"side-bar-select__option ".concat(m===t.types.USERS?"active":"")},"Users")),s.a.createElement("div",{className:"users",ref:"users",onClick:function(t){t.target===e.refs.user&&o(null)}},m===t.types.CHATS?a.map(function(t){if(t.name){var n=t.users.find(function(e){return e!==c.name})||"Community";return s.a.createElement(C,{key:t.id,name:t.isCommunity?t.name:n,lastMessage:Object(S.get)(Object(S.last)(t.messages),"message",""),active:i.id===t.id,onClick:function(){e.props.setActiveChat(t)}})}return null}):Object(S.differenceBy)(r,[c],"name").map(function(t){return s.a.createElement(C,{key:t.id,name:t.name,onClick:function(){e.addChatForUser(t.name)}})})),s.a.createElement("div",{className:"current-user"},s.a.createElement("span",null,c.name),s.a.createElement("div",{onClick:function(){l()},title:"Logout",className:"logout"},s.a.createElement(g.a,null))))}}]),t}(a.Component));b.types={USERS:"users",CHATS:"chats"};var y=function(e){function t(e){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.online,a=e.numberOfUsers,i=n?"online":"offline";return s.a.createElement("div",{className:"chat-header"},s.a.createElement("div",{className:"user-info"},s.a.createElement("div",{className:"user-name"},t),s.a.createElement("div",{className:"status"},s.a.createElement("div",{className:"indicator ".concat(i)}),s.a.createElement("span",null,a||null," online"))),s.a.createElement("div",{className:"options"},s.a.createElement(f.e,null),s.a.createElement(f.d,null),s.a.createElement(f.b,null)))}}]),t}(a.Component),O=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).blur=function(){n.refs.messageinput.blur()},n.state={message:"",isTyping:!1},n.handleSubmit=n.handleSubmit.bind(Object(E.a)(n)),n.sendMessage=n.sendMessage.bind(Object(E.a)(n)),n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.stopCheckingTyping()}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.sendMessage(),this.setState({message:""})}},{key:"sendMessage",value:function(){this.props.sendMessage(this.state.message),this.blur()}},{key:"sendTyping",value:function(){this.lastUpdateTime=Date.now(),this.state.isTyping||(this.setState({isTyping:!0}),this.props.sendTyping(!0),this.startCheckingTyping())}},{key:"startCheckingTyping",value:function(){var e=this;this.typingInterval=setInterval(function(){Date.now()-e.lastUpdateTime>300&&(e.setState({isTyping:!1}),e.stopCheckingTyping())},300)}},{key:"stopCheckingTyping",value:function(){this.typingInterval&&(clearInterval(this.typingInterval),this.props.sendTyping(!1))}},{key:"render",value:function(){var e=this,t=this.state.message;return s.a.createElement("div",{className:"message-input"},s.a.createElement("form",{onSubmit:this.handleSubmit,className:"message-form"},s.a.createElement("input",{id:"message",ref:"messageinput",type:"text",className:"form-control",value:t,autoComplete:"off",placeholder:"Type something to send",onKeyUp:function(t){13!==t.keyCode&&e.sendTyping()},onChange:function(t){var n=t.target.value;e.setState({message:n})}}),s.a.createElement("button",{disabled:t.length<1,type:"submit",className:"send"},"Send")))}}]),t}(a.Component),k=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).scrollDown=n.scrollDown.bind(Object(E.a)(n)),n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"scrollDown",value:function(){var e=this.refs.container;e.scrollTop=e.scrollHeight}},{key:"componentDidUpdate",value:function(e){this.scrollDown()}},{key:"componentDidMount",value:function(){this.scrollDown()}},{key:"render",value:function(){var e=this.props,t=e.messages,n=e.user,a=e.typingUsers;return s.a.createElement("div",{ref:"container",className:"thread-container"},s.a.createElement("div",{className:"thread"},t.map(function(e,t){return s.a.createElement("div",{key:e.id,className:"message-container ".concat(e.sender===n.name&&"right")},s.a.createElement("div",{className:"time"},e.time),s.a.createElement("div",{className:"data"},s.a.createElement("div",{className:"message"},e.message),s.a.createElement("div",{className:"name"},e.sender)))}),a.map(function(e){return s.a.createElement("div",{key:e,className:"typing-user"},"".concat(e," is typing . . ."))})))}}]),t}(a.Component),N=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).sendOpenPrivateMessage=function(e){var t=n.props,a=t.socket,s=t.user;a.emit(v.PRIVTE_MESSAGE,{reciever:e,sender:s.name})},n.deinitialize=function(){var e=n.props.socket;e.off(v.PRIVTE_MESSAGE),e.off(v.USER_CONNECTED),e.off(v.USER_DISCONNECTED)},n.removeSocketEvents=function(e,t){t.length>0&&(e.off(t[0]),n.removeSocketEvents(e,t.slice(1)))},n.resetChat=function(e){return console.log("reset chat"),n.addChat(e,!0)},n.addChat=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=n.props.socket,s=n.state.chats,i=[].concat(Object(p.a)(s),[e]);n.setState({chats:i,activeChat:t?e:n.state.activeChat});var c="".concat(v.MESSAGE_RECIEVED,"-").concat(e.id),r="".concat(v.TYPING,"-").concat(e.id);a.on(c,n.addMessageToChat(e.id)),a.on(r,n.updateTypingChat(e.id))},n.setActiveChat=function(e){n.setState({activeChat:e})},n.addMessageToChat=function(e){return function(t){var a=n.state.chats.map(function(n){return n.id===e&&n.messages.push(t),n});n.setState({chats:a})}},n.updateTypingChat=function(e){return function(t){var a=t.isTyping,s=t.user;if(console.log("typing",e),s!==n.props.user.name){var i=n.state.chats.map(function(t){return t.id===e&&(a&&!t.typingUsers.includes(s)?t.typingUsers.push(s):!a&&t.typingUsers.includes(s)&&(t.typingUsers=t.typingUsers.filter(function(e){return e!==s}))),t});n.setState({chats:i})}}},n.sendMessage=function(e,t){n.props.socket.emit(v.MESSAGE_SENT,{chatId:e,message:t})},n.sendTyping=function(e,t){n.props.socket.emit(v.TYPING,{chatId:e,isTyping:t})},n.state={chats:[],users:[],activeChat:null,communityChat:null},n.resetChat=n.resetChat.bind(Object(E.a)(n)),n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){console.log("chat container"),this.props.socket.emit(v.COMMUNITY_CHAT,this.resetChat),this.initSocket()}},{key:"componentWillUnmount",value:function(){this.deinitialize()}},{key:"initSocket",value:function(){var e=this,t=this.props,n=t.socket,a=t.user;n.on(v.PRIVTE_MESSAGE,this.addChat),n.on("connect",function(){n.emit(v.COMMUNITY_CHAT,e.resetChat)}),n.on(v.USER_CONNECTED,function(t){e.setState({users:Object(S.values)(t)})}),n.on(v.USER_DISCONNECTED,function(t){e.setState({users:Object(S.values)(t)})}),n.emit(v.PRIVTE_MESSAGE,{reciever:"random name",sender:a.name})}},{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.logout,i=this.state,c=i.chats,r=i.activeChat,o=i.users;return s.a.createElement("div",{className:"container"},s.a.createElement(b,{logout:a,chats:c,user:n,users:o,activeChat:r,setActiveChat:this.setActiveChat,onSendPrivateMessage:this.sendOpenPrivateMessage}),s.a.createElement("div",{className:"chat-room-container"},null!==r?s.a.createElement("div",{className:"chat-room"},s.a.createElement(y,{name:r.name}),s.a.createElement(k,{messages:r.messages,user:n,typingUsers:r.typingUsers}),s.a.createElement(O,{sendMessage:function(t){e.sendMessage(r.id,t)},sendTyping:function(t){e.sendTyping(r.id,t)}})):s.a.createElement("div",{className:"chat-room choose"},s.a.createElement("h3",null,"Choose a Chat!"))))}}]),t}(a.Component),T=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).setUser=function(e){var t=e.user,a=e.isUser;console.log(t,a),a?n.setError("Username taken"):(n.setError(""),n.props.setUser(t))},n.handleSubmit=function(e){e.preventDefault();var t=n.props.socket,a=n.state.nickname;t.emit(v.VERIFY_USER,a,n.setUser)},n.handleChange=function(e){n.setState({nickname:e.target.value})},n.setError=function(e){n.setState({error:e})},n.state={nickname:"",error:""},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.nickname;t.error;return s.a.createElement("div",{className:"login"},s.a.createElement("form",{onSubmit:this.handleSubmit,className:"login-form"},s.a.createElement("label",{htmlFor:"nickname"},s.a.createElement("h2",null,"Got a nickname ?")),s.a.createElement("input",{ref:function(t){e.textInput=t},type:"text",id:"nickname",value:n,onChange:this.handleChange,placeholder:"MyCoolusername"}),s.a.createElement("div",null,this.state.error)))}}]),t}(a.Component),j="/",U=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).initSocket=function(){var e=h()(j);e.on("connect",function(){n.state.user?n.reconnect(e):console.log("Connected")}),n.setState({socket:e})},n.setUser=function(e){n.state.socket.emit(v.USER_CONNECTED,e),n.setState({user:e})},n.reconnect=function(e){e.emit(v.VERIFY_USER,n.state.user.name,function(e){var t=e.isUser,a=e.user;t?n.setState({user:null}):n.setUser(a)})},n.logout=function(){n.state.socket.emit(v.LOGOUT),n.setState({user:null})},n.state={socket:null,user:null},n}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.initSocket()}},{key:"render",value:function(){var e=this.state,t=e.socket,n=e.user;return s.a.createElement("div",{className:"container"},n?s.a.createElement(N,{socket:t,user:n,logout:this.logout}):s.a.createElement(T,{socket:t,setUser:this.setUser}))}}]),t}(a.Component),M=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return s.a.createElement(U,{title:"Chat APp baby"})}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[41,1,2]]]);
//# sourceMappingURL=main.d0775b74.chunk.js.map